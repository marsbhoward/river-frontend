{"ast":null,"code":"/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst {\n  helper,\n  assert\n} = require('./helper');\n\nclass Tracing {\n  /**\n   * @param {!Puppeteer.CDPSession} client\n   */\n  constructor(client) {\n    this._client = client;\n    this._recording = false;\n    this._path = '';\n  }\n  /**\n   * @param {!{path?: string, screenshots?: boolean, categories?: !Array<string>}} options\n   */\n\n\n  async start(options = {}) {\n    assert(!this._recording, 'Cannot start recording trace while already recording trace.');\n    const defaultCategories = ['-*', 'devtools.timeline', 'v8.execute', 'disabled-by-default-devtools.timeline', 'disabled-by-default-devtools.timeline.frame', 'toplevel', 'blink.console', 'blink.user_timing', 'latencyInfo', 'disabled-by-default-devtools.timeline.stack', 'disabled-by-default-v8.cpu_profiler', 'disabled-by-default-v8.cpu_profiler.hires'];\n    const {\n      path = null,\n      screenshots = false,\n      categories = defaultCategories\n    } = options;\n    if (screenshots) categories.push('disabled-by-default-devtools.screenshot');\n    this._path = path;\n    this._recording = true;\n    await this._client.send('Tracing.start', {\n      transferMode: 'ReturnAsStream',\n      categories: categories.join(',')\n    });\n  }\n  /**\n   * @return {!Promise<!Buffer>}\n   */\n\n\n  async stop() {\n    let fulfill;\n    const contentPromise = new Promise(x => fulfill = x);\n\n    this._client.once('Tracing.tracingComplete', event => {\n      helper.readProtocolStream(this._client, event.stream, this._path).then(fulfill);\n    });\n\n    await this._client.send('Tracing.end');\n    this._recording = false;\n    return contentPromise;\n  }\n\n}\n\nmodule.exports = Tracing;","map":{"version":3,"sources":["/Users/marshoward/Development/code/river/frontend/app/node_modules/puppeteer/lib/Tracing.js"],"names":["helper","assert","require","Tracing","constructor","client","_client","_recording","_path","start","options","defaultCategories","path","screenshots","categories","push","send","transferMode","join","stop","fulfill","contentPromise","Promise","x","once","event","readProtocolStream","stream","then","module","exports"],"mappings":"AAAA;;;;;;;;;;;;;;;AAeA,MAAM;AAACA,EAAAA,MAAD;AAASC,EAAAA;AAAT,IAAmBC,OAAO,CAAC,UAAD,CAAhC;;AAEA,MAAMC,OAAN,CAAc;AACZ;;;AAGAC,EAAAA,WAAW,CAACC,MAAD,EAAS;AAClB,SAAKC,OAAL,GAAeD,MAAf;AACA,SAAKE,UAAL,GAAkB,KAAlB;AACA,SAAKC,KAAL,GAAa,EAAb;AACD;AAED;;;;;AAGA,QAAMC,KAAN,CAAYC,OAAO,GAAG,EAAtB,EAA0B;AACxBT,IAAAA,MAAM,CAAC,CAAC,KAAKM,UAAP,EAAmB,6DAAnB,CAAN;AAEA,UAAMI,iBAAiB,GAAG,CACxB,IADwB,EAClB,mBADkB,EACG,YADH,EACiB,uCADjB,EAExB,6CAFwB,EAEuB,UAFvB,EAGxB,eAHwB,EAGP,mBAHO,EAGc,aAHd,EAG6B,6CAH7B,EAIxB,qCAJwB,EAIe,2CAJf,CAA1B;AAMA,UAAM;AACJC,MAAAA,IAAI,GAAG,IADH;AAEJC,MAAAA,WAAW,GAAG,KAFV;AAGJC,MAAAA,UAAU,GAAGH;AAHT,QAIFD,OAJJ;AAMA,QAAIG,WAAJ,EACEC,UAAU,CAACC,IAAX,CAAgB,yCAAhB;AAEF,SAAKP,KAAL,GAAaI,IAAb;AACA,SAAKL,UAAL,GAAkB,IAAlB;AACA,UAAM,KAAKD,OAAL,CAAaU,IAAb,CAAkB,eAAlB,EAAmC;AACvCC,MAAAA,YAAY,EAAE,gBADyB;AAEvCH,MAAAA,UAAU,EAAEA,UAAU,CAACI,IAAX,CAAgB,GAAhB;AAF2B,KAAnC,CAAN;AAID;AAED;;;;;AAGA,QAAMC,IAAN,GAAa;AACX,QAAIC,OAAJ;AACA,UAAMC,cAAc,GAAG,IAAIC,OAAJ,CAAYC,CAAC,IAAIH,OAAO,GAAGG,CAA3B,CAAvB;;AACA,SAAKjB,OAAL,CAAakB,IAAb,CAAkB,yBAAlB,EAA6CC,KAAK,IAAI;AACpDzB,MAAAA,MAAM,CAAC0B,kBAAP,CAA0B,KAAKpB,OAA/B,EAAwCmB,KAAK,CAACE,MAA9C,EAAsD,KAAKnB,KAA3D,EAAkEoB,IAAlE,CAAuER,OAAvE;AACD,KAFD;;AAGA,UAAM,KAAKd,OAAL,CAAaU,IAAb,CAAkB,aAAlB,CAAN;AACA,SAAKT,UAAL,GAAkB,KAAlB;AACA,WAAOc,cAAP;AACD;;AAnDW;;AAsDdQ,MAAM,CAACC,OAAP,GAAiB3B,OAAjB","sourcesContent":["/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst {helper, assert} = require('./helper');\n\nclass Tracing {\n  /**\n   * @param {!Puppeteer.CDPSession} client\n   */\n  constructor(client) {\n    this._client = client;\n    this._recording = false;\n    this._path = '';\n  }\n\n  /**\n   * @param {!{path?: string, screenshots?: boolean, categories?: !Array<string>}} options\n   */\n  async start(options = {}) {\n    assert(!this._recording, 'Cannot start recording trace while already recording trace.');\n\n    const defaultCategories = [\n      '-*', 'devtools.timeline', 'v8.execute', 'disabled-by-default-devtools.timeline',\n      'disabled-by-default-devtools.timeline.frame', 'toplevel',\n      'blink.console', 'blink.user_timing', 'latencyInfo', 'disabled-by-default-devtools.timeline.stack',\n      'disabled-by-default-v8.cpu_profiler', 'disabled-by-default-v8.cpu_profiler.hires'\n    ];\n    const {\n      path = null,\n      screenshots = false,\n      categories = defaultCategories,\n    } = options;\n\n    if (screenshots)\n      categories.push('disabled-by-default-devtools.screenshot');\n\n    this._path = path;\n    this._recording = true;\n    await this._client.send('Tracing.start', {\n      transferMode: 'ReturnAsStream',\n      categories: categories.join(',')\n    });\n  }\n\n  /**\n   * @return {!Promise<!Buffer>}\n   */\n  async stop() {\n    let fulfill;\n    const contentPromise = new Promise(x => fulfill = x);\n    this._client.once('Tracing.tracingComplete', event => {\n      helper.readProtocolStream(this._client, event.stream, this._path).then(fulfill);\n    });\n    await this._client.send('Tracing.end');\n    this._recording = false;\n    return contentPromise;\n  }\n}\n\nmodule.exports = Tracing;\n"]},"metadata":{},"sourceType":"script"}